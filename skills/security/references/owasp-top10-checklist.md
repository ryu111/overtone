# OWASP Top 10 å®‰å…¨å¯©æŸ¥æ¸…å–®

> ğŸ“‹ **ä½•æ™‚è®€å–**ï¼šåŸ·è¡Œå®‰å…¨æƒææˆ–éœ€è¦å®Œæ•´ OWASP æª¢æŸ¥æŒ‡å¼•æ™‚ã€‚

## A01: Broken Access Controlï¼ˆå­˜å–æ§åˆ¶å¤±æ•ˆï¼‰

### æª¢æŸ¥è¦é»
- [ ] é è¨­æ‹’çµ•åŸå‰‡ï¼šé™¤å…¬é–‹è³‡æºå¤–ï¼Œé è¨­æ‹’çµ•å­˜å–
- [ ] CORS è¨­å®šï¼šä¸ä½¿ç”¨è¬ç”¨å­—å…ƒ `*`ï¼Œæ˜ç¢ºåˆ—å‡ºå…è¨±çš„ origin
- [ ] è·¯å¾‘ç©¿è¶Šé˜²è­·ï¼šæª”æ¡ˆæ“ä½œä½¿ç”¨ç™½åå–®æˆ– sanitize è·¯å¾‘
- [ ] é€Ÿç‡é™åˆ¶ï¼šAPI endpoints æœ‰é©ç•¶çš„ rate limiting
- [ ] JWT/Sessionï¼šé©—è­‰ token çš„ç°½åã€éæœŸæ™‚é–“ã€audience

### å¸¸è¦‹æ¼æ´
```
// âŒ ä¸å®‰å…¨ï¼šç›´æ¥ä½¿ç”¨ä½¿ç”¨è€…è¼¸å…¥çš„ ID
app.get('/api/users/:id', (req, res) => {
  return db.users.findById(req.params.id);
});

// âœ… å®‰å…¨ï¼šé©—è­‰ä½¿ç”¨è€…åªèƒ½å­˜å–è‡ªå·±çš„è³‡æ–™
app.get('/api/users/:id', (req, res) => {
  if (req.params.id !== req.user.id && !req.user.isAdmin) {
    return res.status(403).json({ error: 'Forbidden' });
  }
  return db.users.findById(req.params.id);
});
```

### ä¿®å¾©æŒ‡å¼•
1. å¯¦ä½œåŸºæ–¼è§’è‰²çš„å­˜å–æ§åˆ¶ï¼ˆRBACï¼‰
2. åœ¨ä¼ºæœå™¨ç«¯é©—è­‰æ‰€æœ‰å­˜å–æ¬Šé™
3. åœç”¨ç›®éŒ„åˆ—è¡¨ï¼Œç¢ºä¿ metadataï¼ˆ.gitã€.envï¼‰ä¸å¯å­˜å–
4. è¨˜éŒ„å­˜å–æ§åˆ¶å¤±æ•—ä¸¦åœ¨åµæ¸¬åˆ°ç•°å¸¸æ™‚ç™¼å‡ºè­¦å‘Š

## A02: Cryptographic Failuresï¼ˆåŠ å¯†æ©Ÿåˆ¶å¤±æ•ˆï¼‰

### æª¢æŸ¥è¦é»
- [ ] å‚³è¼¸åŠ å¯†ï¼šæ‰€æœ‰ API ä½¿ç”¨ HTTPS/TLS 1.2+
- [ ] å¯†ç¢¼å­˜å„²ï¼šä½¿ç”¨ bcrypt/scrypt/argon2ï¼Œä¸ç”¨ MD5/SHA1
- [ ] æ•æ„Ÿè³‡æ–™ï¼šä¸åœ¨ URL query string ä¸­å‚³é€ token æˆ–å¯†ç¢¼
- [ ] Key ç®¡ç†ï¼šå¯†é‘°ä¸ç¡¬ç·¨ç¢¼ï¼Œä½¿ç”¨ç’°å¢ƒè®Šæ•¸æˆ– KMS
- [ ] éš¨æ©Ÿæ•¸ï¼šä½¿ç”¨ crypto-safe éš¨æ©Ÿæ•¸ç”Ÿæˆå™¨

### å¸¸è¦‹æ¼æ´
```
// âŒ ä¸å®‰å…¨
const hash = crypto.createHash('md5').update(password).digest('hex');

// âœ… å®‰å…¨
const hash = await bcrypt.hash(password, 12);
```

### ä¿®å¾©æŒ‡å¼•
1. åˆ†é¡è™•ç†çš„è³‡æ–™ï¼ˆå€‹è³‡ã€è²¡å‹™ã€å¥åº·ï¼‰ï¼Œå°æ•æ„Ÿè³‡æ–™åŠ å¯†
2. ä¸ä½¿ç”¨å·²æ£„ç”¨çš„åŠ å¯†æ¼”ç®—æ³•ï¼ˆMD5ã€SHA1ã€DESï¼‰
3. åŠ å¯†å¯†é‘°ä½¿ç”¨å®‰å…¨çš„éš¨æ©Ÿæ•¸ç”¢ç”Ÿï¼Œä¸¦å®šæœŸè¼ªæ›

## A03: Injectionï¼ˆæ³¨å…¥æ”»æ“Šï¼‰

### æª¢æŸ¥è¦é»
- [ ] SQLï¼šä½¿ç”¨ parameterized query æˆ– ORMï¼Œä¸æ‹¼æ¥å­—ä¸²
- [ ] NoSQLï¼šMongoDB query é©—è­‰ input é¡å‹
- [ ] XSSï¼šæ‰€æœ‰ä½¿ç”¨è€…è¼¸å…¥åœ¨è¼¸å‡ºæ™‚ç·¨ç¢¼/è½‰ç¾©
- [ ] å‘½ä»¤æ³¨å…¥ï¼šä¸ä½¿ç”¨ `exec()`/`eval()` è™•ç†ä½¿ç”¨è€…è¼¸å…¥
- [ ] LDAP/XML/SMTPï¼šå°æ‡‰ injection é˜²è­·

### å¸¸è¦‹æ¼æ´
```
// âŒ SQL injection
const query = `SELECT * FROM users WHERE id = ${req.params.id}`;

// âœ… Parameterized query
const query = 'SELECT * FROM users WHERE id = $1';
const result = await db.query(query, [req.params.id]);
```

```
// âŒ XSS
element.innerHTML = userInput;

// âœ… å®‰å…¨
element.textContent = userInput;
```

### ä¿®å¾©æŒ‡å¼•
1. ä½¿ç”¨å®‰å…¨çš„ APIï¼ˆparameterized queryã€ORMï¼‰
2. ä¼ºæœå™¨ç«¯é©—è­‰æ‰€æœ‰è¼¸å…¥ï¼ˆç™½åå–®å„ªæ–¼é»‘åå–®ï¼‰
3. è¼¸å‡ºæ™‚ç·¨ç¢¼ç‰¹æ®Šå­—å…ƒ
4. ä½¿ç”¨ Content-Security-Policy header

## A04: Insecure Designï¼ˆä¸å®‰å…¨çš„è¨­è¨ˆï¼‰

### æª¢æŸ¥è¦é»
- [ ] å¨è„…æ¨¡å‹ï¼šæ˜¯å¦è­˜åˆ¥äº†ä¸»è¦å¨è„…
- [ ] æœ€å°æ¬Šé™ï¼šç³»çµ±å…ƒä»¶æ˜¯å¦åªæœ‰å¿…è¦çš„æ¬Šé™
- [ ] åˆ†å±¤é˜²ç¦¦ï¼šä¸ä¾è³´å–®ä¸€å®‰å…¨æ§åˆ¶
- [ ] å®‰å…¨é è¨­ï¼šåŠŸèƒ½é è¨­ç‚ºå®‰å…¨ç‹€æ…‹

### ä¿®å¾©æŒ‡å¼•
1. åœ¨è¨­è¨ˆéšæ®µé€²è¡Œå¨è„…å»ºæ¨¡
2. å»ºç«‹å®‰å…¨çš„è¨­è¨ˆ pattern åº«
3. åœ¨ user story ä¸­åŠ å…¥å®‰å…¨éœ€æ±‚

## A05: Security Misconfigurationï¼ˆå®‰å…¨è¨­å®šéŒ¯èª¤ï¼‰

### æª¢æŸ¥è¦é»
- [ ] é è¨­å¸³è™Ÿå¯†ç¢¼ï¼šå·²ç§»é™¤æˆ–è®Šæ›´
- [ ] éŒ¯èª¤è¨Šæ¯ï¼šä¸æ´©éœ² stack trace æˆ–ç³»çµ±è³‡è¨Šåˆ° production
- [ ] HTTP headersï¼šè¨­å®š X-Frame-Optionsã€X-Content-Type-Optionsã€Strict-Transport-Security
- [ ] ä¸å¿…è¦çš„åŠŸèƒ½ï¼šåœç”¨æœªä½¿ç”¨çš„ HTTP methodsã€ç›®éŒ„åˆ—è¡¨
- [ ] ä¾è³´æ›´æ–°ï¼šç„¡å·²çŸ¥æ¼æ´çš„ä¾è³´ç‰ˆæœ¬

### å¸¸è¦‹æ¼æ´
```
// âŒ æ´©éœ²ç³»çµ±è³‡è¨Š
app.use((err, req, res, next) => {
  res.status(500).json({ error: err.stack });
});

// âœ… å®‰å…¨çš„éŒ¯èª¤è™•ç†
app.use((err, req, res, next) => {
  logger.error(err);
  res.status(500).json({ error: 'Internal server error' });
});
```

### ä¿®å¾©æŒ‡å¼•
1. å¯é‡è¤‡çš„å®‰å…¨è¨­å®šåŠ å›ºæµç¨‹
2. ç§»é™¤ä¸éœ€è¦çš„åŠŸèƒ½å’Œæ¡†æ¶
3. å®šæœŸå¯©æŸ¥å’Œæ›´æ–°è¨­å®š

## A06: Vulnerable and Outdated Componentsï¼ˆæœ‰æ¼æ´å’Œéæ™‚çš„å…ƒä»¶ï¼‰

### æª¢æŸ¥è¦é»
- [ ] ä¾è³´ç‰ˆæœ¬ï¼šåŸ·è¡Œ `npm audit` / `pip audit`
- [ ] éæ™‚å…ƒä»¶ï¼šç„¡ EOLï¼ˆEnd of Lifeï¼‰çš„ä¾è³´
- [ ] Licenseï¼šç„¡ä¸ç›¸å®¹çš„ license
- [ ] å­ä¾è³´ï¼šæ·±å±¤ä¾è³´ä¹Ÿéœ€æª¢æŸ¥

### ä¿®å¾©æŒ‡å¼•
1. ç§»é™¤ä¸ä½¿ç”¨çš„ä¾è³´å’ŒåŠŸèƒ½
2. æŒçºŒç›£æ§ CVE è³‡æ–™åº«
3. åªå¾å®˜æ–¹ä¾†æºç²å–å…ƒä»¶

## A07: Identification and Authentication Failuresï¼ˆèº«ä»½è­˜åˆ¥å’Œé©—è­‰å¤±æ•—ï¼‰

### æª¢æŸ¥è¦é»
- [ ] æš´åŠ›ç ´è§£é˜²è­·ï¼šå¸³è™Ÿé–å®šæˆ–æ¼¸é€²å¼å»¶é²
- [ ] å¯†ç¢¼ç­–ç•¥ï¼šæœ€å°é•·åº¦ã€è¤‡é›œåº¦ã€å¸¸è¦‹å¯†ç¢¼é»‘åå–®
- [ ] MFAï¼šé«˜æ•æ„Ÿæ“ä½œæ”¯æ´å¤šå› ç´ é©—è­‰
- [ ] Sessionï¼šç™»å‡ºå¾Œå³æ™‚å¤±æ•ˆã€ä¸åœ¨ URL ä¸­æš´éœ² session ID
- [ ] å¯†ç¢¼é‡è¨­ï¼šä½¿ç”¨å®‰å…¨çš„é‡è¨­æµç¨‹ï¼ˆé™æ™‚ token + å–®æ¬¡ä½¿ç”¨ï¼‰

### ä¿®å¾©æŒ‡å¼•
1. å¯¦ä½œ MFA
2. ä¸ä½¿ç”¨é è¨­å¯†ç¢¼
3. å¯†ç¢¼å¼·åº¦é©—è­‰ï¼ˆå°ç…§å¸¸è¦‹å¯†ç¢¼åº«ï¼‰
4. é™åˆ¶å¤±æ•—ç™»å…¥å˜—è©¦æ¬¡æ•¸

## A08: Software and Data Integrity Failuresï¼ˆè»Ÿé«”å’Œè³‡æ–™å®Œæ•´æ€§å¤±æ•—ï¼‰

### æª¢æŸ¥è¦é»
- [ ] CI/CD å®‰å…¨ï¼špipeline è¨­å®šæœ‰é©ç•¶æ¬Šé™æ§åˆ¶
- [ ] ä¾è³´å®Œæ•´æ€§ï¼šä½¿ç”¨ lock file å’Œ checksum é©—è­‰
- [ ] ååºåˆ—åŒ–ï¼šä¸ä¿¡ä»»ä½¿ç”¨è€…æä¾›çš„åºåˆ—åŒ–è³‡æ–™
- [ ] è‡ªå‹•æ›´æ–°ï¼šæ›´æ–°é€šé“ä½¿ç”¨ç°½åé©—è­‰

### ä¿®å¾©æŒ‡å¼•
1. ä½¿ç”¨æ•¸ä½ç°½åé©—è­‰è»Ÿé«”å’Œè³‡æ–™
2. npm/pip lock file ç´å…¥ç‰ˆæœ¬æ§åˆ¶
3. å¯©æŸ¥ CI/CD pipeline è¨­å®šè®Šæ›´

## A09: Security Logging and Monitoring Failuresï¼ˆå®‰å…¨æ—¥èªŒå’Œç›£æ§å¤±æ•—ï¼‰

### æª¢æŸ¥è¦é»
- [ ] ç™»å…¥/ç™»å‡º/å¤±æ•—ï¼šæ˜¯å¦è¨˜éŒ„
- [ ] å­˜å–æ§åˆ¶å¤±æ•—ï¼šæ˜¯å¦è¨˜éŒ„
- [ ] è¼¸å…¥é©—è­‰å¤±æ•—ï¼šæ˜¯å¦è¨˜éŒ„ï¼ˆå« source IPï¼‰
- [ ] Log injectionï¼šlog è¼¸å…¥æ˜¯å¦ sanitize
- [ ] å‘Šè­¦ï¼šç•°å¸¸è¡Œç‚ºæ˜¯å¦è§¸ç™¼å‘Šè­¦

### ä¿®å¾©æŒ‡å¼•
1. ç¢ºä¿æ‰€æœ‰å­˜å–æ§åˆ¶ã€é©—è­‰å¤±æ•—éƒ½æœ‰ log
2. Log æ ¼å¼æ¨™æº–åŒ–ï¼Œä¾¿æ–¼è‡ªå‹•åŒ–åˆ†æ
3. å»ºç«‹ç›£æ§å’Œå‘Šè­¦æ©Ÿåˆ¶

## A10: Server-Side Request Forgery (SSRF)ï¼ˆä¼ºæœå™¨ç«¯è«‹æ±‚å½é€ ï¼‰

### æª¢æŸ¥è¦é»
- [ ] URL é©—è­‰ï¼šä¸ç›´æ¥ä½¿ç”¨ä½¿ç”¨è€…è¼¸å…¥çš„ URL ç™¼é€è«‹æ±‚
- [ ] ç™½åå–®ï¼šé™åˆ¶å…è¨±å­˜å–çš„å¤–éƒ¨è³‡æº
- [ ] å…§ç¶²é˜²è­·ï¼šé˜»æ­¢å­˜å– 169.254.x.xã€10.x.x.x ç­‰å…§ç¶²åœ°å€
- [ ] å›æ‡‰è™•ç†ï¼šä¸ç›´æ¥å›å‚³é ç«¯å›æ‡‰

### å¸¸è¦‹æ¼æ´
```
// âŒ SSRF
app.get('/proxy', async (req, res) => {
  const response = await fetch(req.query.url);
  res.send(await response.text());
});

// âœ… å®‰å…¨ï¼šé©—è­‰ + ç™½åå–®
app.get('/proxy', async (req, res) => {
  const url = new URL(req.query.url);
  if (!ALLOWED_HOSTS.includes(url.hostname)) {
    return res.status(403).json({ error: 'Host not allowed' });
  }
  const response = await fetch(url.toString());
  res.send(await response.text());
});
```

### ä¿®å¾©æŒ‡å¼•
1. URL schemeã€portã€ç›®æ¨™ IP éƒ½éœ€é©—è­‰
2. ä¸ç›´æ¥å°‡ raw response å›å‚³çµ¦ä½¿ç”¨è€…
3. åœç”¨ HTTP é‡å®šå‘æˆ–é™åˆ¶é‡å®šå‘æ¬¡æ•¸

## æƒæå ±å‘Šæ ¼å¼

```markdown
## å®‰å…¨æƒæå ±å‘Š

### æ‘˜è¦
- æƒæç¯„åœï¼š[æè¿°]
- æƒææ™‚é–“ï¼š[æ™‚é–“]
- åˆ¤å®šï¼šPASS / REJECT

### ç™¼ç¾ï¼ˆæŒ‰åš´é‡ç¨‹åº¦æ’åºï¼‰

#### ğŸ”´ Critical
[ç„¡ / å•é¡Œæè¿° + ä¿®å¾©å»ºè­°]

#### ğŸŸ  High
[ç„¡ / å•é¡Œæè¿° + ä¿®å¾©å»ºè­°]

#### ğŸŸ¡ Medium
[ç„¡ / å•é¡Œæè¿° + ä¿®å¾©å»ºè­°]

#### ğŸ”µ Low
[ç„¡ / å•é¡Œæè¿° + ä¿®å¾©å»ºè­°]
```
