# BDD è¡Œç‚ºè¦æ ¼æŒ‡å—

> ğŸ“‹ **ä½•æ™‚è®€å–**ï¼šåŸ·è¡Œ TEST:spec éšæ®µæˆ–éœ€è¦æ’°å¯« BDD è¡Œç‚ºè¦æ ¼æ™‚ã€‚

## GIVEN/WHEN/THEN èªæ³•

BDD spec ä½¿ç”¨ä¸‰æ®µå¼èªæ³•æè¿°è¡Œç‚ºï¼š

```gherkin
Feature: [åŠŸèƒ½åç¨±]
  [åŠŸèƒ½ç°¡è¿°]

  Scenario: [å ´æ™¯åç¨±]
    Given [å‰ç½®æ¢ä»¶]
    And [é¡å¤–å‰ç½®æ¢ä»¶]ï¼ˆå¯é¸ï¼‰
    When [å‹•ä½œ/è§¸ç™¼]
    And [é¡å¤–å‹•ä½œ]ï¼ˆå¯é¸ï¼‰
    Then [é æœŸçµæœ]
    And [é¡å¤–é æœŸ]ï¼ˆå¯é¸ï¼‰
```

### èªæ³•è¦å‰‡

- **Given**ï¼šæè¿°ç³»çµ±çš„åˆå§‹ç‹€æ…‹ï¼ˆè³‡æ–™åº«ä¸­æœ‰ä½¿ç”¨è€…ã€æœå‹™æ­£åœ¨é‹è¡Œ...ï¼‰
- **When**ï¼šæè¿°è§¸ç™¼è¡Œç‚ºçš„å‹•ä½œï¼ˆä½¿ç”¨è€…é»æ“Šã€API è¢«å‘¼å«...ï¼‰
- **Then**ï¼šæè¿°å¯è§€å¯Ÿçš„é æœŸçµæœï¼ˆå›æ‡‰ 200ã€è³‡æ–™åº«æ›´æ–°...ï¼‰
- **And**ï¼šå»¶ä¼¸ä¸Šä¸€å€‹æ­¥é©Ÿï¼Œé¿å… Given/When/Then é‡è¤‡

### å¯«ä½œåŸå‰‡

1. ä½¿ç”¨**æ¥­å‹™èªè¨€**è€ŒéæŠ€è¡“èªè¨€ï¼ˆã€Œä½¿ç”¨è€…ç™»å…¥ã€éã€ŒPOST /api/authã€ï¼‰
2. æ¯å€‹ Scenario æ¸¬è©¦**ä¸€å€‹è¡Œç‚º**
3. Given æè¿°**å¯è§€å¯Ÿç‹€æ…‹**ï¼Œä¸æè¿°å¯¦ä½œç´°ç¯€
4. Then æè¿°**å¯é©—è­‰çµæœ**ï¼Œä¸æè¿°å…§éƒ¨ç‹€æ…‹

## spec/verify é›™æ¨¡å¼

### TEST:specï¼ˆDEV å‰ï¼‰

- **æ™‚æ©Ÿ**ï¼šåœ¨ developer é–‹å§‹å¯«ç¢¼å‰
- **ç›®çš„**ï¼šå®šç¾©ã€Œåšå®Œé•·ä»€éº¼æ¨£ã€
- **ç”¢å‡º**ï¼š`specs/features/in-progress/{featureName}/bdd.md` ä¸­çš„è¡Œç‚ºè¦æ ¼
- **èª°å¯«**ï¼štester agentï¼ˆmode: specï¼‰
- **è¼¸å…¥**ï¼šarchitect æˆ– planner çš„ Handoff

### TEST:verifyï¼ˆDEV å¾Œï¼‰

- **æ™‚æ©Ÿ**ï¼šåœ¨ developer å®Œæˆå¯¦ä½œå¾Œ
- **ç›®çš„**ï¼šé©—è­‰ã€Œåšå®Œçš„æ±è¥¿æ˜¯å¦ç¬¦åˆè¦æ ¼ã€
- **ç”¢å‡º**ï¼šæ¸¬è©¦çµæœï¼ˆPASS / FAILï¼‰
- **èª°å¯«**ï¼štester agentï¼ˆmode: verifyï¼‰
- **è¼¸å…¥**ï¼šdeveloper çš„ Handoff + BDD spec

## æœ€å°‘å ´æ™¯è¦å‰‡

ğŸ“‹ æ¯å€‹ Feature MUST åŒ…å«è‡³å°‘ 3 å€‹ Scenarioï¼š

1. **Happy Path** â€” æ­£å¸¸æµç¨‹ï¼Œé æœŸæˆåŠŸ
2. **Edge Case** â€” é‚Šç•Œæ¢ä»¶ï¼ˆç©ºå€¼ã€è¶…é•·å­—ä¸²ã€ä¸¦è¡Œæ“ä½œ...ï¼‰
3. **Error Case** â€” éŒ¯èª¤è™•ç†ï¼ˆç„¡æ•ˆè¼¸å…¥ã€æ¬Šé™ä¸è¶³ã€æœå‹™ä¸å¯ç”¨...ï¼‰

## Scenario Outlineï¼ˆè³‡æ–™é©…å‹•ï¼‰

ç•¶å¤šå€‹å ´æ™¯çµæ§‹ç›¸åŒä½†è³‡æ–™ä¸åŒæ™‚ï¼Œä½¿ç”¨ Scenario Outlineï¼š

```gherkin
Scenario Outline: é©—è­‰å¯†ç¢¼å¼·åº¦
  Given ä½¿ç”¨è€…åœ¨è¨»å†Šé é¢
  When ä½¿ç”¨è€…è¼¸å…¥å¯†ç¢¼ "<password>"
  Then ç³»çµ±é¡¯ç¤ºå¼·åº¦ç‚º "<strength>"

  Examples:
    | password    | strength |
    | abc         | å¼±       |
    | Abc12345    | ä¸­       |
    | Abc!@#12345 | å¼·       |
```

## å®‰å…¨åŠŸèƒ½çš„ BDD spec

æ¶‰åŠèªè­‰ã€æ”¯ä»˜ã€å®‰å…¨æ•æ„ŸåŠŸèƒ½æ™‚ï¼ŒBDD spec ğŸ“‹ MUST é¡å¤–æ¶µè“‹ï¼š

### æ”»æ“Šå ´æ™¯

```gherkin
Scenario: é˜»æ“‹ SQL injection æ”»æ“Š
  Given ä½¿ç”¨è€…åœ¨ç™»å…¥é é¢
  When ä½¿ç”¨è€…è¼¸å…¥å¸³è™Ÿ "admin' OR '1'='1"
  And ä½¿ç”¨è€…è¼¸å…¥å¯†ç¢¼ "anything"
  Then ç³»çµ±å›å‚³ã€Œå¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ã€
  And ç³»çµ±è¨˜éŒ„æ­¤æ¬¡å¯ç–‘ç™»å…¥å˜—è©¦
```

### å®‰å…¨ BDD spec å¿…è¦å ´æ™¯

1. **æ­£å¸¸èªè­‰/æˆæ¬Šæµç¨‹**
2. **ç„¡æ•ˆ/éæœŸ token è™•ç†**
3. **æ³¨å…¥æ”»æ“Šé˜²è­·**ï¼ˆSQLã€XSSã€å‘½ä»¤æ³¨å…¥ï¼‰
4. **æ¬Šé™è¶Šç•Œå˜—è©¦**ï¼ˆæ°´å¹³/å‚ç›´ææ¬Šï¼‰
5. **æš´åŠ›ç ´è§£é˜²è­·**ï¼ˆrate limitingï¼‰

## Specs ç›®éŒ„æ•´åˆ

BDD spec å­˜æ”¾åœ¨ `specs/features/in-progress/{featureName}/` ç›®éŒ„ä¸‹ï¼š

```
specs/
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ in-progress/
â”‚   â”‚   â””â”€â”€ {featureName}/
â”‚   â”‚       â”œâ”€â”€ tasks.md   # å·¥ä½œæ¸…å–® + frontmatter
â”‚   â”‚       â””â”€â”€ bdd.md     # BDD è¡Œç‚ºè¦æ ¼
â”‚   â”œâ”€â”€ backlog/           # å¾…è¾¦ feature
â”‚   â””â”€â”€ archive/           # å·²å®Œæˆï¼ˆè‡ªå‹•æ­¸æª”ï¼‰
â””â”€â”€ README.md
```

### ä½•æ™‚å»ºç«‹ BDD spec

- **å¤§ä¸­å‹åŠŸèƒ½**ï¼ˆstandard/full/secure/refactor/tddï¼‰â†’ å»ºç«‹ tasks.md + bdd.md
- **å¿«é€Ÿä»»å‹™**ï¼ˆquick/debugï¼‰â†’ åªå»ºç«‹ tasks.md
- **å°ä»»å‹™**ï¼ˆsingle/review-only ç­‰ï¼‰â†’ è·³é specs

## Tag åˆ†é¡

ç‚º Scenario åŠ ä¸Š tag åˆ†é¡ä¾¿æ–¼é¸æ“‡æ€§åŸ·è¡Œï¼š

```gherkin
@smoke @auth
Scenario: ä½¿ç”¨æœ‰æ•ˆå¸³å¯†ç™»å…¥
  ...

@security @auth
Scenario: é˜»æ“‹æš´åŠ›ç ´è§£
  ...

@edge-case @auth
Scenario: åŒæ™‚ç™»å…¥å¤šå€‹è£ç½®
  ...
```

å¸¸ç”¨ tagï¼š`@smoke`ï¼ˆå†’ç…™æ¸¬è©¦ï¼‰ã€`@security`ï¼ˆå®‰å…¨ï¼‰ã€`@edge-case`ï¼ˆé‚Šç•Œï¼‰ã€`@regression`ï¼ˆå›æ­¸ï¼‰ã€`@slow`ï¼ˆæ…¢æ¸¬è©¦ï¼‰
